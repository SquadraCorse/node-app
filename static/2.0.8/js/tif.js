/*  jQuery Deparam - v0.1.0 - 6/14/2011
        http://benalman.com/
        Copyright (c) 2011 Ben Alman; Licensed MIT, GPL
        https://gist.github.com/cowboy/1025817
    */

define("tif/js/tif-utils",["v2/lib/jquery","v2/lib/lodash","tif/constants"],function(e,t,n){var r={},i={country:n.country,COUNTRY:n.country.toUpperCase(),language:n.language,LANGUAGE:n.language.toUpperCase()};return r.rewriteUrl=function(e,n){var r=/\{(.+?)\}/g,s=t.extend(i,n),o=e.replace(r,function(e,t){return s[t]});return o},r.getParamsFromHash=function(){var t=window.location.hash.substring(1),n,r=decodeURIComponent,i=function(t,n){var s={};return e.each(t.replace(/\+/g," ").split("&"),function(t,o){var u=o.split("="),a=r(u[0]);if(!a)return;var f=r(u[1]||""),l=a.split("]["),c=l.length-1,h=0,p=s;l[0].indexOf("[")>=0&&/\]$/.test(l[c])?(l[c]=l[c].replace(/\]$/,""),l=l.shift().split("[").concat(l),c++):c=0,e.isFunction(n)?f=n(a,f):n&&(f=i.reviver(a,f));if(c)for(;h<=c;h++)a=l[h]!==""?l[h]:p.length,h<c?p=p[a]=p[a]||(isNaN(l[h+1])?{}:[]):p[a]=f;else e.isArray(s[a])?s[a].push(f):a in s?s[a]=[s[a],f]:s[a]=f}),s};return i.reviver=function(e,t){var r={"true":!0,"false":!1,"null":null,"undefined":n};return+t+""===t?+t:t in r?r[t]:t},i(t,!0)},r.containsSameProperties=function(e,n){var r=!0;return e=t.clone(e),t.each(n,function(n,i){t.isArray(e[i])&&e[i].length===1&&(e[i]=e[i][0]),t.isEqual(e[i],n)||(r=!1)}),r},r}),define("tif/js/tif-regions",["v2/lib/lodash","tif/constants","tif/regions-data","tif/i18n"],function(e,t,n,r){var i={};return i.init=function(){this.world={},this.world.continents={},r.continents={},r.countries={},r.cities={},r.themes={},e.each(n.continents,function(t,n){r.continents[n]=t.name,e.each(t.countries,function(t,i){r.countries[i]=t.name,this.world.continents[n]=this.world.continents[n]||{},this.world.continents[n].countries=this.world.continents[n].countries||{},e.each(t.cities,function(e,t){r.cities[t]=e,this.world.continents[n].countries[i]=this.world.continents[n].countries[i]||{},this.world.continents[n].countries[i].cities=this.world.continents[n].countries[i].cities||{},this.world.continents[n].countries[i].cities[t]=e},this)},this)},this),e.each(n.themes,function(e,n){r.themes[n]={name:e,icon:t.themeIconMap[n]}},this),this.sortedContinents=[],e.each(r.continents,function(e,t){this.sortedContinents.push({code:t,name:e})},this),this.sortedContinents=e.sortBy(this.sortedContinents,function(e){return e.name}),this.sortedContinents=e.pluck(this.sortedContinents,"code"),this.sortedCountries=[],e.each(r.countries,function(e,t){this.sortedCountries.push({code:t,name:e})},this),this.sortedCountries=e.sortBy(this.sortedCountries,function(e){return e.name}),this.sortedCountries=e.pluck(this.sortedCountries,"code")},i});var AFKL=window.AFKL||{};define("tif/js/tif-measure",["v2/lib/jquery","v2/lib/lodash","tif/constants","v2/g-mi"],function(e,t,n){AFKL.mi=AFKL.mi||[],AFKL.mi.push(["_add",{TC:{tif:{z_country:n.country,z_language:n.language,z_application:"TIF",z_app_version:n.version,cg_n:"TIF",z_host:"KL"},"tif.page":{},"tif.page.search":{ti:"Travel guide - KLM.com",cg_s:"results"},"tif.page.search.onload":{z_event:"offered",z_eventplace:"results page"},"tif.page.search:onclick":{z_event:"clicked",z_eventplace:"results page"},"tif.page.search.change":{z_event:"clicked",z_eventplace:"results page"},"tif.page.search.viewtoggle":{z_eventtype:"view",z_eventvalue:function(){return this.element.getAttribute("data-event-value")}},"tif.page.search.filter":{z_eventvalue:function(){return this.element.getAttribute("data-event-value")}},"tif.page.search.filter.continent":{z_eventtype:"continent filter"},"tif.page.search.filter.country":{z_eventtype:"country filter"},"tif.page.search.filter.theme":{z_eventtype:"theme filter"},"tif.page.search.change.budgetfilter":{z_eventtype:"budget filter"},"tif.page.search.change.freetextfilter":{z_eventtype:"freetext filter"},"tif.page.search.filter.crumb":{z_eventtype:"filter crumb"},"tif.page.search.change.sort":{z_eventtype:"sort"},"tif.page.search.filter.breadcrumb":{z_eventtype:"bread crumb"},"tif.page.search.change.origin":{z_eventtype:"origin"},"tif.page.destination":{ti:n.destName,cg_s:"destination",cg_s1:n.destName,cg_s2:n.activeTab,z_destination:n.destName},"tif.page.destination.onload":{z_event:"offered",z_eventplace:"destination page"},"tif.page.destination:onclick":{z_event:"clicked",z_eventplace:"destination page"},"tif.page.destination.regionfilter":{z_eventtype:"regionfilter",z_eventvalue:function(){return this.element.getAttribute("data-event-value")}},"tif.page.destination.change":{z_event:"clicked",z_eventplace:"destination page"},"tif.page.destination.filter":{z_eventvalue:function(){return this.element.getAttribute("data-event-value")}},"tif.page.destination.filter.continent":{z_eventtype:"continent filter"},"tif.page.destination.filter.country":{z_eventtype:"country filter"},"tif.page.destination.filter.theme":{z_eventtype:"theme filter"},"tif.page.destination.change.budgetfilter":{z_eventtype:"budget filter"},"tif.page.destination.change.freetextfilter":{z_eventtype:"freetext filter"},"tif.page.destination.filter.breadcrumb":{z_eventtype:"bread crumb"},"tif.page.destination.change.origin":{z_eventtype:"origin"},"tif.page.destination.backtosearch":{z_eventtype:"backtosearch",z_eventvalue:"backtosearch"},"tif.page.destination.pricebox":{z_eventtype:"pricebox",z_eventvalue:"pricebox"},"tif.page.destination.tabs":{z_eventtype:"tab",z_eventvalue:function(){return this.element.getAttribute("data-event-value")}}}}]);var r,i,s=["continent","country","theme","budget"],o=function(e,t){r=e,t?(i=t,i.on("reset",a)):r.on("change",u)},u=function(){var e=[],r=[];if(n.storageSupport&&window.sessionStorage.getItem("tif:model")){var i=JSON.parse(window.sessionStorage.getItem("tif:model"));t.each(s,function(n){i[n]&&(t.isArray(i[n])?t.each(i[n],function(t){e.push(n),r.push(t)}):(e.push(n),r.push(i[n])))})}AFKL.mi.push(["_add",{TC:{"tif.page.destination.onload":{z_filter_type:e.join("_")||"",z_filter_value:r.join("_")||"",z_origin:this.get("origin"),z_tab:this.get("tab")}}}])},a=function(){var e=[],n=[];t.each(r.toJSON(),function(r,i){t.contains(s,i)&&t.isArray(r)&&t.each(r,function(t){e.push(i),n.push(t)},this)},this),AFKL.mi.push(["_add",{TC:{"tif.page.search":{z_filter_type:e.join("_"),z_filter_value:n.join("_"),z_refinement:e.length,z_filter_results:i.length,z_origin:r.get("origin")||"",z_sortBy:r.get("sortBy")||"",z_view:r.get("view")||""}}}])},f=function(e,t){var n={};n.TC={},n.TC[e]=t||{},AFKL.mi.push(["_add",n]),AFKL.mi.push(["_measure",e])};return{init:o,send:f}}),define("tif/js/models/DestinationPageModel",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-measure","tif/js/tif-utils"],function(e,t,n,r,i,s){var o=n.Model.extend({defaults:{origin:!1,pos:!1,tab:!1,articleTheme:"all"},hasPushState:!!window.history&&!!history.pushState,urlRegex:new RegExp(r.destinationUrl+"/?([\\-a-z]*)"),initialize:function(){var t=this;t.$window=e(window),t.$window.on("hashchange",function(){t.urlChanged()}),this.hasPushState&&t.$window.on("popstate",function(){t.urlChanged()}),this.on("change",this.modelChanged,this)},modelChanged:function(){var n=this,i=this.toJSON(),o=s.getParamsFromHash(),u=e(window).scrollTop(),a={};t.each(o,function(e,n){t.has(i,n)||(a[n]=e)}),delete i.origin,delete i.pos,t.each(i,function(e,r){(e===""||e===null||e===!1||t.isEqual(e,n.defaults[r]))&&delete i[r]},n);var f="";n.hasPushState&&window.location.pathname.search(n.urlRegex)!==-1&&(i.tab!=="overview"&&(f="/"+i.tab),delete i.tab);var l=t.extend(i,a);l=e.param(l,!0);if(n.hasPushState&&window.location.pathname.search(n.urlRegex)!==-1){var c=r.destinationUrl+f;c!==location.pathname?(l&&(c+="#"+l),history.pushState(null,null,c)):window.location.hash=l}else window.location.hash=l;n.$window.scrollTop(u)},urlChanged:function(){r.scroll&&(r.scroll=!1,setTimeout(function(){e("html, body").animate({scrollTop:e(".tif-content").offset().top},500)},1e3));var n=s.getParamsFromHash();if(window.location.pathname.search(this.urlRegex)!==-1){var i=this.urlRegex.exec(window.location.pathname)[1];this.hasPushState?n.tab=i:!n.tab&&this.get("tab")===this.defaults.tab&&(n.tab=i)}t.each(n,function(e,t){typeof this.attributes[t]=="undefined"&&delete n[t]},this),t.each(this.attributes,function(e,i){switch(i){case"origin":n[i]=r.defaultOrigin;break;case"pos":n[i]=r.defaultPos;break;case"tab":if(t.isEmpty(n[i])||!n[i].match(/^[\-a-z]*$/))n[i]="overview";break;case"articleTheme":t.isEmpty(n[i])&&(n[i]=this.defaults[i])}},this),this.set(n)}});return o}),define("tif/js/models/SearchPageModel",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-regions","tif/js/tif-utils"],function(e,t,n,r,i,s){var o=n.Model.extend({defaults:{origin:!1,pos:!1,continent:[],country:[],theme:[],budget:null,view:e(window).width()>r.tabletBreakpoint?"block":"list",sortBy:"popularity",visibleItems:0},initialize:function(){this.set("visibleItems",this._calculateViewLimit());var t=this;e(window).on("hashchange",function(){t.urlChanged()}),this.on("change",this.modelChanged,this)},modelChanged:function(){var n=this.toJSON(),i=s.getParamsFromHash(),o={};t.each(i,function(e,r){t.has(n,r)||(o[r]=e)}),t.each(n,function(e,r){(e===""||e===null||e===!1||t.isEqual(e,this.defaults[r]))&&delete n[r]},this);try{r.storageSupport&&window.sessionStorage.setItem("tif:model",JSON.stringify(n))}catch(u){}delete n.visibleItems,delete n.origin,delete n.pos;var a=t.extend(n,o);a=e.param(a,!0);var f=e(window).scrollTop();window.location.hash=a,e(window).scrollTop(f)},urlChanged:function(){var e=s.getParamsFromHash();this.set(this.validateHash(e))},validateHash:function(e){return t.each(e,function(t,n){typeof this.attributes[n]=="undefined"&&delete e[n]},this),t.each(this.attributes,function(n,s){switch(s){case"origin":e[s]=r.defaultOrigin;break;case"pos":e[s]=r.defaultPos;break;case"continent":e[s]?t.isArray(e[s])?t.each(e[s],function(n){t.contains(i.sortedContinents,n)||(e[s]=t.without(e[s],n))}):t.contains(i.sortedContinents,e[s])?e[s]=[e[s]]:e[s]=this.defaults[s]:e[s]=this.defaults[s];break;case"country":e[s]?t.isArray(e[s])?t.each(e[s],function(n){t.contains(i.sortedCountries,n)||(e[s]=t.without(e[s],n))}):t.contains(i.sortedCountries,e[s])?e[s]=[e[s]]:e[s]=this.defaults[s]:e[s]=this.defaults[s];break;case"theme":if(e[s])if(t.isArray(e[s])){while(e[s].length>2)e[s].pop();t.each(e[s],function(n){t.contains(t.keys(r.themeIconMap),n)||(e[s]=t.without(e[s],n))})}else t.contains(t.keys(r.themeIconMap),e[s])?e[s]=[e[s]]:e[s]=this.defaults[s];else e[s]=this.defaults[s];break;case"budget":if(typeof e[s]!="number"||e[s]<=0)e[s]=this.defaults[s];break;case"view":if(t.isEmpty(e[s])||typeof r.viewModes[e[s]]=="undefined")e[s]=this.defaults[s];break;case"sortBy":if(t.isEmpty(e[s])||t.indexOf(t.pluck(r.sortModes,"mode"),e[s])<0)e[s]=this.defaults[s];break;case"visibleItems":delete e[s]}},this),e},increaseVisibleItems:function(){this.set("visibleItems",this.get("visibleItems")+this._calculateViewLimit())},resetVisibleItems:function(t){this.set("visibleItems",this._calculateViewLimit(t),{silent:!0})},_calculateViewLimit:function(e){return r.viewModes[e||this.get("view")].pageLimit||9}});return o}),define("tif/js/models/DestinationModel",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone"],function(e,t,n){var r=n.Model.extend({idAttribute:"destinationCode"});return r}),define("tif/js/collections/AllDestinationsCollection",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/i18n","tif/js/tif-utils","tif/js/models/DestinationModel"],function(e,t,n,r,i,s,o){var u=function(e){var n=[];return t.each(e,function(e){var r={popularity:e.popularity,destinationCode:e.destination.code,countryCode:e.destination.country,continentCode:e.destination.continent,links:e.links,coordinates:e.destination.coordinates,minimumPrice:{currency:e.lowestFare.currency,displayPrice:e.lowestFare.value},themes:t.pluck(e.themes,"category")};e.possibleTravelTime&&(r.flightDuration={hours:e.possibleTravelTime.hours,minutes:e.possibleTravelTime.minutes}),n.push(r)}),n},a=n.Collection.extend({model:o,fetch:function(t,n,i){var s=this,o="tif:destinations";if(!t||!n)return;var a=function(){s.trigger("startFetching"),e.ajax({url:r.allDestinationsUrl,dataType:"json",data:{origin:t,pos:n,fields:"themes,possibleTravelTime"}}).done(function(e){var t=u(e);if(t&&t.length){r.currency=t[0].minimumPrice.currency,s._enrich(t),s.reset(t);try{window.sessionStorage.setItem(o,JSON.stringify(t))}catch(n){}i()}else s.trigger("showNoResultMessage")}).fail(function(){s.trigger("showNoResultMessage")}).always(function(){s.trigger("fetchingDone")})};if(r.storageSupport&&window.sessionStorage.getItem(o)){var f=JSON.parse(window.sessionStorage.getItem(o)),l=(new Date).getTime(),c=l-f.timestamp;if(t!==f.origin||c>18e5)window.sessionStorage.removeItem(o),a();else{var h=f.destinations;r.currency=h[0].minimumPrice.currency,this.reset(h),i()}}else a()},_enrich:function(e){t.each(e,function(e){var n={};t.each(e.themes,function(e){n[e]={name:i.themes[e].name,icon:i.themes[e].icon}}),e.flightDuration=e.flightDuration||null,e.destinationName=i.cities[e.destinationCode]||e.destinationCode,e.countryName=i.countries[e.countryCode]||e.countryCode,e.continentName=i.continents[e.continentCode]||e.continentCode,e.themes=n,e.contentEnriched=!1})}});return a}),define("tif/js/collections/FilteredDestinationsCollection",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","v2/g-mi","tif/constants","tif/js/tif-measure","tif/js/models/DestinationModel"],function(e,t,n,r,i,s,o){var u=n.Collection.extend({model:o,initialize:function(e,t){t=t||{},this.allDestinationsCollection=t.allDestinationsCollection,this.destinations=[],this.pageModel=t.pageModel,this.pageModel.on("change",this.doFilter,this),this.pageModel.on("change:origin",this.resetDestinations,this),this.on("reset",this.enrichDestinationsWithContent,this),this.on("reset",this.sendTags,this)},resetDestinations:function(){this.destinations=[]},doFilter:function(){var e=this.allDestinationsCollection.filter(function(e){if(this.pageModel.get("country").length>0||this.pageModel.get("continent").length>0)if(t.indexOf(this.pageModel.get("country"),e.get("countryCode"))===-1&&t.indexOf(this.pageModel.get("continent"),e.get("continentCode"))===-1)return!1;return this.pageModel.get("theme").length>0&&t.intersection(this.pageModel.get("theme"),t.keys(e.get("themes"))).length!==this.pageModel.get("theme").length?!1:this.pageModel.get("budget")>0&&e.get("minimumPrice").displayPrice>this.pageModel.get("budget")?!1:!0},this);this.reset(e);if(!e.length){var n=this.pageModel.previousAttributes();if(this.pageModel.changedAttributes().origin){var r=this;this.allDestinationsCollection.fetch(n.origin,n.pos,function(){r.pageModel.set(n)})}else this.pageModel.set(n)}},enrichDestinationsWithContent:function(n,r){var s=this,o=!t.isEmpty(r),u=this.first(this.pageModel.get("visibleItems")),a=t.filter(u,function(e){return!e.get("contentEnriched")});if(a.length||o){var f=[];o&&t.isString(r)&&f.push(r),t.each(a,function(e){t.indexOf(s.destinations,e.id)===-1&&f.push(e.id),s.destinations.push(e.id)});if(t.isEmpty(f)===!0)return;var l=t.first(f,20),c=i.contentEnrichmentUrl+l.join(","),h=e.getJSON(c,function(e){s.processContent(e,f)}).fail(function(){s.processContent([],f)});return h}},processContent:function(e,n){var r=[];t.each(e,function(e){var t=this.get(e.destinationCode);t&&(r.push(e.destinationCode),t.set({introText:e.introText,visualUrlSmall:e.visualUrlSmall,visualUrlMedium:e.visualUrlMedium,caption:e.caption,compId:e.compId,lastPublished:e.lastPublished,lastChanged:e.lastChanged,contentEnriched:!0}))},this);var s=t.difference(n,r);t.each(s,function(e){var t=this.get(e);t&&t.set({contentEnriched:!0})},this);var o="tif:destinations";try{if(i.storageSupport){var u={};u.timestamp=(new Date).getTime(),u.origin=this.pageModel.get("origin"),u.destinations=this.allDestinationsCollection.toJSON(),window.sessionStorage.setItem(o,JSON.stringify(u))}}catch(a){}this.trigger("contentEnrichmentDone")},comparator:function(e){var n="",r=this.pageModel.get("sortBy");switch(r){case"popularity":return e.get("popularity")||5;case"priceLowestFirst":return e.get("minimumPrice").displayPrice;case"priceHighestFirst":return-e.get("minimumPrice").displayPrice;case"destinationNameAZ":return e.get("destinationName");case"destinationNameZA":return String.fromCharCode.apply(String,t.map(e.get("destinationName").split(""),function(e){return 65535-e.charCodeAt()}));case"flightDurationLowestFirst":return n=e.get("flightDuration")?e.get("flightDuration").hours*60+e.get("flightDuration").minutes:9999,n;case"flightDurationHighestFirst":return n=e.get("flightDuration")?e.get("flightDuration").hours*60+e.get("flightDuration").minutes:0,-n}}});return u}),define("tif/js/views/DestinationView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants"],function(e,t,n,r){var i=n.View.extend({initialize:function(e){this.firstTime=!0,this.destinationPageModel=e.pageModel,this.destinationPageModel.on("change:origin",this._tabChangeWidget,this),this.destinationPageModel.on("tabLoaded",this._tabStartWidget,this),this._searchTabFlights=!1,this._searchParameters={country:r.country,language:r.language,destination:r.destCode}},_tabChangeWidget:function(){this.firstTime?(this._tabStartWidget(),this.firstTime=!1):this._searchTabFlights&&(this._searchParameters.origin=this.destinationPageModel.get("origin"),this._appendWidget(this._searchTabFlights))},_appendWidget:function(t){var n=e.param(this._searchParameters),r="/ams/search/calendar/calendar.js?"+n+"&container="+t;r+="&view=MultiMonthView&application=TIF&canModify=ORIGIN,DESTINATION,TRAVELDATES,PAX,CABINCLASS",e.getScript(r)},_tabStartWidget:function(){this._searchParameters.origin=this.destinationPageModel.get("origin")||r.defaultOrigin;var e=this.destinationPageModel.get("tab"),t="tif-search-widget-tab-"+e;e==="flights"&&!this._searchTabFlights&&(this._searchTabFlights=t,this._appendWidget(t))}});return i}),define("v2/lib/text!tif/templates/destination-block-template.html",[],function(){return'<div class="tif-search-destination g-clear"\n    data-dest=<@=data.destinationCode@>\n    data-tcm-id="<@-typeof(data.compId) !== \'undefined\' ? data.compId : \'n/a\'@>"\n    data-tcm-last-published="<@-typeof(data.lastChanged)!== \'undefined\' ? data.lastChanged : \'n/a\'@>"\n    data-tcm-last-updated="<@-typeof(data.lastPublished)!== \'undefined\' ? data.lastPublished : \'n/a\'@>">\n\n    <!-- tif.cms.tcm: <@-typeof(data.compId) !== \'undefined\' ? data.compId : \'n/a\'@>|<@-typeof(data.lastChanged)!== \'undefined\' ? data.lastChanged : \'n/a\'@>|<@-typeof(data.lastPublished)!== \'undefined\' ? data.lastPublished : \'n/a\'@> -->\n\n    <div class="tif-search-destination-image">\n\n        <a href="<@=data.destinationUrl@>" class="tif-figure tif-image-default">\n            <@ if (typeof data.visualUrlSmall !== \'undefined\' && data.visualUrlSmall) {@>\n            <span data-srcset="<@=data.visualUrlSmall@> 1.5x, <@=data.visualUrlMedium@> 2x" class="js-g-img g-img-lazy g-img-ratio-1-1" data-img-type="lazy"></span>\n            <@ } @>\n            <@ if (typeof data.caption !== \'undefined\' && data.caption) {@>\n            <div class="tif-figure-figcaption">\n                <div class="tif-figure-figcaption-text">\n                    <span class="tif-icon">&#xe61e;</span> <@=data.caption@> <span class="g-klmicon tif-icon-gt-small">&gt;</span>\n                </div>\n            </div>\n            <@ } @>\n        </a>\n\n    </div>\n    <div class="tif-search-destination-wrapper">\n        <div class="tif-search-destination-header">\n            <div class="g-font-klm tif-h3">\n                <@=data.countryName@>\n                <span><@=i18n.tif_search_roundtripprice@>:</span>\n            </div>\n            <div class="g-font-klm tif-h2">\n                <a class="tif-search-destination-header-name" href="<@=data.destinationUrl @>"><@=data.destinationName@></a>\n                <@ if (data.minimumPrice) { @>\n                <a class="tif-search-destination-header-price" href="<@=data.destinationPriceUrl @>"><em><@=data.minimumPrice.currency@></em><@=data.minimumPrice.displayPrice@></a>\n                <@ } @>\n            </div>\n        </div>\n        <div class="tif-search-destination-content g-line-dotted">\n            <@ if (typeof data.introText !== \'undefined\' && data.introText) { @>\n                <div><@=data.introText@></div>\n            <@ } @>\n            <a class="tif-search-destination-read-more g-btn g-btn-forward" href="<@=data.destinationUrl @>"><span>\n                <@ if (data.linkMap[\'overview\']) { @>\n                    <@=i18n.tif_search_destination_button.replace(/\\{0\\}/, data.destinationName)@>\n                <@ } else { @>\n                    <@=i18n.tif_search_destination_flights_button.replace(/\\{0\\}/, data.destinationName)@>\n                <@ } @>\n                <b class="g-klmicon">&gt;</b></span></a>\n        </div>\n        <div class="tif-search-destination-footer">\n            <ul class="first">\n                <@ if (data.flightDuration) { @>\n                <li class="tif-search-destination-footer-travelduration">\n                    <span class="g-klmicon">&#x1f554;</span> <@=data.flightDuration.hours@><@=i18n.tif_search_listview_hoursinoneletter@> <@=data.flightDuration.minutes@><@=i18n.tif_search_listview_minutesinoneletter@>\n                </li>\n                <@ } @>\n                <li style="display:none"><span class="g-klmicon">&#x2708;</span></li>\n                <li style="display:none"><span class="tif-icon">&#xe600;</span> - &deg;C</li>\n            </ul>\n            <ul class="tif-search-destination-footer-themes">\n                <@ _.each(data.themes, function(theme) { @>\n                    <li><span class="tif-icon"><@=theme.icon@></span> <@=theme.name@></li>\n                <@ }); @>\n            </ul>\n        </div>\n    </div>\n</div>'});var KLM=KLM||{};define("tif/js/tif-map",["v2/lib/lodash","tif/js/tif-img-responsive","tif/i18n","tif/constants","tif/js/tif-utils","v2/lib/text!tif/templates/destination-block-template.html"],function(e,t,n,r,i,s){KLM.tif=KLM.tif||{};var o=document,u=!1,a=!1,f,l,c,h,p,d=r.googleKey,v="//maps.googleapis.com/maps/api/js?v=3.exp&key="+d+"&sensor=false&callback=KLM.tif.mapInit",m,g=[],y=[],b=r.staticPath+"/img/map-view-marker.png",w=e.template(s),E="tif-map-marker",S=function(){a&&(p=l.toJSON(),x(),k())},x=function(){for(var e=0;e<g.length;e++)g[e].setMap(null);N(),window.google&&google.maps.event.clearInstanceListeners(m),g.length=0,y.length=0},T=function(e){var t=p[e],s={origin:f.get("origin"),pos:f.get("pos"),destination:t.destinationCode};t.linkMap={};for(var o=0;o<t.links.length;o++)t.linkMap[t.links[o].rel]=t.links[o].href;t.linkMap.flights&&(t.destinationUrl=i.rewriteUrl(t.linkMap.flights,s),t.destinationPriceUrl=i.rewriteUrl(t.linkMap.flights,s)),t.linkMap.overview&&(t.destinationUrl=i.rewriteUrl(t.linkMap.overview,s)),t.linkMap.calendar&&(t.destinationUrl=i.rewriteUrl(t.linkMap.calendar,s),t.destinationPriceUrl=i.rewriteUrl(t.linkMap.calendar,s)),t.contentEnriched&&(t.visualUrlSmall=t.visualUrlSmall||r.staticPath+"/img/destination-default-image.jpg",t.visualUrlMedium=t.visualUrlMedium||r.staticPath+"/img/destination-default-image.jpg");var u=w({data:t,i18n:n.labels}),a='<div class="'+E+'">'+u+"</div>";return a},N=function(){for(var e=0;e<y.length;e++)y[e]&&y[e].close()},C=function(e){N();if(!y[e]){var n=new google.maps.InfoWindow({content:T(e)});y[e]=n;var r=p[e].destinationCode,i=l.enrichDestinationsWithContent(null,r);i&&i.success(function(){p=l.toJSON();var t=T(e);y[e].setContent(t)}),google.maps.event.addListener(y[e],"domready",function(){t.crawl({container:"."+E})})}y[e].open(m,g[e])},k=function(){var e=p.length,t,n=function(e){google.maps.event.addListener(e,"click",function(){C(this.infoWindowIndex),c&&c.setAnimation(null),e.setAnimation(google.maps.Animation.BOUNCE),c=e})};if(e===1){var r=new google.maps.LatLng(p[0].coordinates.lat,p[0].coordinates.lon);t=new google.maps.LatLngBounds(r)}else t=new google.maps.LatLngBounds;for(var i=0;i<e;i++){var s=p[i],o=s.coordinates,u=s.destinationName+": "+s.minimumPrice.currency+" "+s.minimumPrice.displayPrice,a=new google.maps.LatLng(o.lat,o.lon),f={url:b,size:new google.maps.Size(32,32),anchor:new google.maps.Point(16,32)},l=new google.maps.Marker({position:a,map:m,title:u,infoWindowIndex:i,icon:f});e>1&&t.extend(a),n(l),g.push(l)}e!==1?m.fitBounds(t):m.setZoom(8),new google.maps.Rectangle({bounds:t,map:m,fillColor:"#000000",fillOpacity:.2,strokeWeight:0}),google.maps.event.addListenerOnce(m,"bounds_changed",function(){var e=this.getZoom();e<2&&(e=3),this.setZoom(e)})};KLM.tif.mapInit=function(){a=!0;var t=o.getElementById(h),n={center:new google.maps.LatLng(22.5,5.75),minZoom:2,maxZoom:13,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};m=new google.maps.Map(t,n),k()};var L=function(){x(),c=KLM.tif.mapInit=null},A=function(){l&&l.on("reset",S)},O=function(){l&&l.off("reset",S)},M=function(e){if(!u){u=!0,f=e.pageModel,h=e.container,l=e.collection,p=l.toJSON(),A();var t="script",n=o.createElement(t),r=o.getElementsByTagName(t)[0];n.src=v,r.parentNode.insertBefore(n,r)}else A(),S()};return{init:M,destroy:L,on:A,off:O}}),define("tif/js/views/SearchView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-map"],function(e,t,n,r,i){var s=n.View.extend({initialize:function(t){this.loadedMap=!1,this.currentView=null,this.pageModel=t.pageModel,this.pageModel.on("change:view",this._render,this),this.pageModel.on("change:visibleItems",this._page,this),this.allDestinationsCollection=t.allDestinationsCollection,this.allDestinationsCollection.on("done",this._render,this),this.filteredDestinationsCollection=t.filteredDestinationsCollection,this.filteredDestinationsCollection.on("reset",this._reset,this),this.$results=e(".tif-search-results"),this.$map=e("#tif-map")},_render:function(){if(this.filteredDestinationsCollection.length===0)return;this.view=this.pageModel.get("view");if(this.view===this.currentView)return;this.currentView=this.view,i.off();switch(this.view){case"map":this.$map.removeClass("g-hidden"),this.$results.addClass("g-hidden"),i.init({container:"tif-map",collection:this.filteredDestinationsCollection,pageModel:this.pageModel});break;case"list":this.$map.addClass("g-hidden"),this.$results.removeClass("g-hidden");break;case"block":this.$map.addClass("g-hidden"),this.$results.removeClass("g-hidden")}},_page:function(){},_reset:function(){if(this.filteredDestinationsCollection.length===0)return;this._render()}});return s}),define("tif/js/views/search/SearchFiltersView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone"],function(e,t,n){var r=n.View.extend({initialize:function(e){this.$el=e},render:function(){this.hideSpinner()},showSpinner:function(){this.$el.find(".tif-search-filters-loading").show()},hideSpinner:function(){this.$el.find(".tif-search-filters-loading").removeClass("tif-search-filters-loading-non-transparent").hide()},close:function(){this.showSpinner();var t=this;setTimeout(function(){t.hideSpinner(),e(".tif-tabs-nav-list .tif-activetab a").trigger("click"),e(".g-newpage .js-g-panel-close").trigger("click")},350)}});return r}),define("v2/lib/text!tif/templates/region-filter-template.html",[],function(){return'<div class="tif-search-filters-loading tif-search-filters-loading-non-transparent g-loading-large"></div>\n<div class="g-grid--row first">\n    <div class="g-grid--indent">\n        <div class="g-grid--span8">\n            <h3 class="g-font-klm tif-h3"><@- i18n.labels.tif_search_filterregion_wheredoyouwanttogo @></h3>\n        </div>\n        <div class="g-grid--span4 tif-search-filters-regions-picker">\n\n            <input type="text" class="g-locationpicker g-locationpicker--destination tif-search-filters-regions-picker-input" placeholder="<@=i18n.labels.tif_search_filterregion_findadestination@>" />\n\n        </div>\n    </div>\n</div>\n<div class="g-grid--row">\n    <div class="g-grid--indent">\n        <div class="g-grid--span3 tif-search-filters-regions-continents">\n            <h4 class="tif-heading-dark tif-h4"><@- i18n.labels.tif_search_filterregion_continents @></h4>\n            <ul></ul>\n        </div>\n        <div class="g-grid--span9 tif-search-filters-regions-countries">\n            <h4 class="tif-heading-dark tif-h4"><@- i18n.labels.tif_search_filterregion_countries @></h4>\n            <ul></ul>\n        </div>\n    </div>\n</div>\n<div class="g-grid--row last">\n    <div class="g-grid--indent">\n        <div class="g-grid--span12 tif-search-filters-greyedout-info tif-search-filters-greyedout-info-hidden">\n            <div>\n                <span class="g-klmicon">&#xe102;</span> <@- i18n.labels.tif_search_filtergrayedoutinfo.replace(/\\{0\\}/, i18n.labels.tif_search_filtergrayedoutinfo_regions) @>\n            </div>\n        </div>\n    </div>\n</div>'}),define("tif/js/views/search/RegionFilterView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/js/tif-locationpicker","tif/constants","tif/js/tif-regions","tif/i18n","tif/js/tif-utils","tif/js/tif-measure","tif/js/views/search/SearchFiltersView","v2/lib/text!tif/templates/region-filter-template.html"],function(e,t,n,r,i,s,o,u,a,f,l){var c={country:i.country,COUNTRY:i.country.toUpperCase(),language:i.language,LANGUAGE:i.language.toUpperCase()},h=f.extend({initialize:function(e,n,r){this.$el=e,this.pageModel=n,this.allDestinationsCollection=r,this.pageModel.on("change:origin change:continent change:country change:theme change:budget",this.render,this),this.pageModel.on("change:origin",this.updateRegionsPicker,this),this.regionsFilterTemplate=t.template(l),this.$el.html(this.regionsFilterTemplate({i18n:o,Constants:i})),this.$continents=this.$el.find(".tif-search-filters-regions-continents ul"),this.$countries=this.$el.find(".tif-search-filters-regions-countries ul"),this.$info=this.$el.find(".tif-search-filters-greyedout-info"),this.$locationPicker=e.find(".tif-search-filters-regions-picker-input"),f.prototype.initialize.apply(this,arguments)},events:{"click .tif-search-filters-regions-continents li":"continentClicked","click .tif-search-filters-regions-countries li":"countryClicked"},render:function(){var e=[],n=[],r=this.pageModel.get("budget")?this.pageModel.get("budget"):1e10,u=this.pageModel.get("theme");this.allDestinationsCollection.each(function(s){i.page==="destination"?(e.push(s.get("continentCode")),n.push(s.get("countryCode"))):t.intersection(u,t.keys(s.get("themes"))).length===u.length&&s.get("minimumPrice").displayPrice<=r&&(e.push(s.get("continentCode")),n.push(s.get("countryCode")))},this),e=t.uniq(e),n=t.uniq(n);var a=!1,l=this.pageModel.get("continent"),c=[];t.each(s.sortedContinents,function(n){var r="js-g-mi",s="";t.indexOf(e,n)===-1?(r+=" tif-search-filters-regions-disabled",a=!0):t.indexOf(l,n)>-1&&(s='<span class="g-klmicon">&#x78;</span>',r+=" tif-search-filters-regions-selected");var u='<li data-code="'+n+'" class="'+r+'" ';u+='data-g-mi="tif.page.'+i.page+'.filter.country" data-event-value="'+n+'">',u+='<a href="#">'+o.continents[n]+"</a>"+s+"</li>",c.push(u)}),this.$continents.html(c.join(""));var h=this.pageModel.get("country"),p=[];t.each(s.sortedCountries,function(e){var r="js-g-mi",s="";t.indexOf(n,e)===-1?(r+=" tif-search-filters-regions-disabled",a=!0):t.indexOf(h,e)>-1&&(s='<span class="g-klmicon">&#x78;</span>',r+=" tif-search-filters-regions-selected");var u='<li data-code="'+e+'" class="'+r+'" ';u+='data-g-mi="tif.page.'+i.page+'.filter.country" data-event-value="'+e+'">',u+='<a href="#">'+o.countries[e]+"</a>"+s+"</li>",p.push(u)}),this.$countries.html(p.join("")),a&&this.$info.removeClass("tif-search-filters-greyedout-info-hidden"),f.prototype.render.apply(this,arguments)},continentClicked:function(n){n.preventDefault();var r=e(n.target).closest("li");if(r.hasClass("tif-search-filters-regions-disabled"))return;var o=r.data("code");if(i.page==="destination"){var u="/destinations/"+i.country+"/"+i.language+"/search#origin="+this.pageModel.get("origin")+"&pos="+this.pageModel.get("pos")+"&continent="+o;window.location=u}else{var a=t.clone(this.pageModel.get("continent")),f=t.clone(this.pageModel.get("country")),l=t.indexOf(a,o);if(l>-1)a.splice(l,1);else{a.push(o);var c=t.keys(s.world.continents[o].countries);f=t.difference(f,c)}this.pageModel.resetVisibleItems(),this.pageModel.set({continent:a,country:f}),this.close()}},countryClicked:function(n){n.preventDefault();var r=e(n.target).closest("li");if(r.hasClass("tif-search-filters-regions-disabled"))return;var o=r.data("code");if(i.page==="destination"){var u=i.searchUrl+"#origin="+this.pageModel.get("origin")+"&pos="+this.pageModel.get("pos")+"&country="+o;window.location=u}else{var a=t.clone(this.pageModel.get("continent")),f=t.clone(this.pageModel.get("country")),l=t.indexOf(f,o);if(l>-1)f.splice(l,1);else{f.push(o);var c;t.each(s.world.continents,function(e,t){o in e.countries&&(c=t)}),a=t.without(a,c)}this.pageModel.resetVisibleItems(),this.pageModel.set({country:f,continent:a}),this.close()}},updateRegionsPicker:function(){this.locationPicker?this.locationPicker.set({country:this.pageModel.get("pos")}):(this.locationPicker=new r({country:this.pageModel.get("pos"),language:i.language,application:"tif",container:this.$locationPicker,type:"destination"}),this.locationPicker.on("selected",this.regionsPickerUsed,this))},regionsPickerUsed:function(){var n=this.locationPicker.get();if(!n){this.locationPicker.set({});return}var r=n.cityCode||n.code,s=t.where(this.allDestinationsCollection.toJSON(),{destinationCode:r});if(s.length){c.origin=this.pageModel.get("origin"),c.pos=this.pageModel.get("pos"),c.destination=n.code;var o=u.rewriteUrl(s[0].links[0].href,c);a.send("tif.page."+i.page+".change.freetextfilter",{z_eventvalue:n.code}),document.location=o}else this.locationPicker.set({}),this.close(),e(".tif-search-no-result-message").removeClass("g-hidden")}});return h}),define("v2/lib/text!tif/templates/themes-filter-template.html",[],function(){return'<div class="tif-search-filters-loading tif-search-filters-loading-non-transparent g-loading-large"></div>\n\n<div class="g-grid--row first">\n    <div class="g-grid--indent">\n        <div class="g-grid--span8">\n            <h3 class="g-font-klm tif-h3"><@=i18n.labels.tif_search_filterthemes_heading@></h3>\n        </div>\n        <div class="g-grid--span4 tif-search-filters-themes-affinity">\n            <!--\n            <button class="g-klmicon tif-search-filters-themes-affinity-button">&#xe103;</button>\n            <input type="text" class="tif-input tif-search-filters-themes-affinity-input" placeholder="<@=i18n.labels.tif_search_filterthemes_affinity @>" />\n            -->\n\n            <!--\n                TODO: HTML active disabled\n                <li><a href="#" class="tif-search-filters-themes-list-activeitem"><span class="tif-icon">&#xe619;</span> Kunst &amp; Cultuur</a></li>\n                <li><a href="#" class="tif-search-filters-themes-list-disableditem"><span class="tif-icon">&#xe619;</span> Kunst &amp; Cultuur</a></li>\n                <li><a href="#"><span class="tif-icon">&#xe603;</span> Kunst &amp; Cultuur</a></li>\n            -->\n\n        </div>\n    </div>\n</div>\n\n\n<div class="g-grid--row">\n    <div class="g-grid--indent">\n\n\n    <@_.each(items, function(obj, count){ @>\n\n        <div class="g-grid--span3 <@ if (count === 4) { @>last<@ } @>">\n\n            <ul class="tif-search-filters-themes-list">\n\n                <@_.each(obj, function(item, number){ @>\n\n                    <@ if (item.available && !item.selected) { @>\n                        <li class="js-g-mi js-tif-themefilter tif-search-filters-themes"\n                            data-g-mi="tif.page.<@=page@>.filter.theme"\n                            data-event-value="<@=item.code@>"\n                            data-code="<@=item.code@>">\n                            <span class="tif-icon"><@=item.icon@></span> <@=item.name@>\n                        </li>\n\n                    <@ } else if (item.available && item.selected) {@>\n\n                        <li class="js-g-mi js-tif-themefilter tif-search-filters-themes tif-search-filters-themes-selected"\n                            data-g-mi="tif.page.<@=page@>.filter.theme"\n                            data-event-value="<@=item.code@>"\n                            data-code="<@=item.code@>">\n                            <span class="tif-icon"><@=item.icon@></span> <@=item.name@></span><span class="g-klmicon">x</span>\n                        </li>\n\n                    <@ } else { @>\n\n                        <li class="tif-search-filters-themes tif-search-filters-themes-disabled" data-code="<@=item.code@>">\n                            <span class="tif-icon"><@=item.icon@></span> <@=item.name@>\n                        </li>\n\n                    <@ } @>\n\n                <@ }) @>\n\n            </ul>\n\n        </div>\n\n    <@ }) @>\n\n\n    </div>\n</div>\n<div class="g-grid--row last">\n    <div class="g-grid--indent">\n        <div class="g-grid--span12 tif-search-filters-greyedout-info tif-search-filters-greyedout-info-hidden">\n            <div>\n                <span class="g-klmicon">&#xe102;</span> <@=i18n.labels.tif_search_filtergrayedoutinfo.replace(/\\{0\\}/, i18n.labels.tif_search_filtergrayedoutinfo_themes)@>\n            </div>\n        </div>\n    </div>\n</div>'}),define("tif/js/views/search/ThemesFilterView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-regions","tif/i18n","tif/js/views/search/SearchFiltersView","v2/lib/text!tif/templates/themes-filter-template.html"],function(e,t,n,r,i,s,o,u){var a=o.extend({initialize:function(e,n,r){this.$el=e,this.pageModel=n,this.filteredCollection=r,this.filteredCollection?this.filteredCollection.on("reset",this._renderSearch,this):this.pageModel.on("change:origin",this._renderDestination,this),this.themesFilterTemplate=t.template(u),o.prototype.initialize.apply(this,arguments),this._availableThemes=[],this._selectedThemes=[],this.MAX=2},events:{"click .js-tif-themefilter":"_onClick"},_onClick:function(n){n.preventDefault();var i=this._selectedThemes.length||0,s=e(n.target).closest("li").attr("data-code");if(r.page==="destination"){var o="/destinations/"+r.country+"/"+r.language+"/search#origin="+this.pageModel.get("origin")+"&pos="+this.pageModel.get("pos")+"&theme="+s;window.location=o}else{var u=t.indexOf(this._selectedThemes,s);u>-1?this._selectedThemes.splice(u,1):i<this.MAX&&this._selectedThemes.push(s),this.pageModel.resetVisibleItems(),this.pageModel.set({theme:this._selectedThemes}),this.close()}},_render:function(){var e=this,n=!1,i=[],u=0,a=0,f=4,l;t.each(s.themes,function(r,s){u%f===0&&a++;var o=!0;e._availableThemes.length&&(o=t.indexOf(e._availableThemes,s)===-1?!1:!0);var l=!1;e._selectedThemes.length&&(l=t.indexOf(e._selectedThemes,s)===-1?!1:!0),e._selectedThemes.length===e.MAX&&!l&&(o=!1),o||(n=!0);var c={name:r.name,icon:r.icon,code:s,available:o,selected:l,group:a};i.push(c),u++}),l=t.groupBy(i,"group"),this.$el.html(this.themesFilterTemplate({i18n:s,Constants:r,items:l,page:r.page||"none"}));var c=this.$el.find(".tif-search-filters-greyedout-info");n?c.removeClass("tif-search-filters-greyedout-info-hidden"):c.addClass("tif-search-filters-greyedout-info-hidden"),o.prototype.render.apply(this,arguments)},_renderSearch:function(){var e=this;e._availableThemes=[];if(!e.filteredCollection.length)return;e._selectedThemes=t.clone(e.pageModel.get("theme")),e.filteredCollection.each(function(n){var r=n.get("themes");t.each(r,function(n,r){e._availableThemes=t.union(e._availableThemes,[r])})}),e._render()},_renderDestination:function(){this._render()}});return a}),define("v2/lib/text!tif/templates/budget-filter-template.html",[],function(){return'<div class="tif-search-filters-loading tif-search-filters-loading-non-transparent g-loading-large"></div>\n<div class="g-grid--row first">\n    <div class="g-grid--indent">\n        <div class="g-grid--span12">\n            <h3 class="g-font-klm tif-h3"><@- I18n.labels.tif_search_filterbudget_heading @></h3>\n        </div>\n    </div>\n</div>\n<div class="g-grid--row last">\n    <div class="g-grid--indent">\n        <div class="g-grid--span8 tif-search-filters-budget-filter-form">\n            <p>\n                <@- I18n.labels.tif_search_filterbudget_form_title @>\n            <p>\n                <input type="number" name="amount" min="0" max="9999999999" maxlength="10" class="g-forms-text tif-search-filters-budget-filter-form-amount" placeholder="" value="<@- budget @>" /> <span class="tif-search-filters-budget-filter-form-currency"><@- currency @></span>\n            </p>\n            <p style="visibility: hidden">\n                <span class="g-forms-field-label">\n                    <input type="checkbox" name="offers" class="g-forms-checkbox"><label class="g-forms-label-text" for="inputa"><@- I18n.labels.tif_search_filterbudget_form_offerslabel @></label>\n                </span>\n            </p>\n            <p>\n                <button type="button" class="tif-search-filters-budget-filter-form-button g-btn g-btn-large g-btn-backward"><span><@- I18n.labels.tif_search_filterbudget_form_button @> <b class="g-klmicon" aria-hidden="true">&gt;</b></span></button>\n            </p>\n        </div>\n        <div class="g-grid--span4"></div>\n    </div>\n</div>'}),define("tif/js/views/search/BudgetFilterView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-regions","tif/i18n","tif/js/tif-measure","tif/js/views/search/SearchFiltersView","v2/lib/text!tif/templates/budget-filter-template.html"],function(e,t,n,r,i,s,o,u,a){var f={I18n:s,Constants:r,currency:""},l=u.extend({initialize:function(e,n){this.$el=e,this.pageModel=n,this.pageModel&&this.pageModel.on("change:origin change:budget",this.render,this),this.BudgetFilterTemplate=t.template(a),u.prototype.initialize.apply(this,arguments)},events:{"click .tif-search-filters-budget-filter-form-button":"_amountAdded","keypress .tif-search-filters-budget-filter-form-amount":"_processKey"},render:function(){f.currency=r.currency,f.budget=this.pageModel.get("budget"),this.$el.html(this.BudgetFilterTemplate(f)),u.prototype.render.apply(this,arguments)},_amountAdded:function(){var e=this.$el.find(".tif-search-filters-budget-filter-form-amount"),t=e.val();o.send("tif.page."+r.page+".change.budgetfilter",{z_eventvalue:t});if(r.page==="destination"){var n="/destinations/"+r.country+"/"+r.language+"/search#origin="+this.pageModel.get("origin")+"&pos="+this.pageModel.get("pos")+"&budget="+t;window.location=n}else this.pageModel.resetVisibleItems(),t.match(/[0-9]/)?this.pageModel.set({budget:Number(t)}):(this.pageModel.set({budget:this.pageModel.defaults.budget}),e.removeAttr("value")),this.close()},_processKey:function(e){e.which===13&&this._amountAdded()}});return l}),define("v2/lib/text!tif/templates/list-view-template.html",[],function(){return'<div class="tif-search-listview-row g-clear g-line-dotted" data-dest="<@=data.destinationCode@>">\n    <div class="tif-search-listview-destination-container">\n        <span class="tif-search-listview-destination"><@=data.destinationName@></span>\n        <span class="tif-search-listview-country"> - <@=data.countryName@></span>\n    </div>\n    <div class="tif-search-listview-travelduration-container">\n        <span class="tif-search-listview-travelduration">\n            <@ if(data.flightDuration) { @>\n                <@=data.flightDuration.hours@><@=i18n.tif_search_listview_hoursinoneletter@>\n                <@=data.flightDuration.minutes@><@=i18n.tif_search_listview_minutesinoneletter@>\n            <@ } @>\n        </span>\n    </div>\n    <div class="tif-search-listview-price-container">\n        <@ if (data.minimumPrice) { @>\n        <span class="tif-search-listview-price"><@=data.minimumPrice.currency@> <@=data.minimumPrice.displayPrice@></span>\n        <@ } @>\n        <a href="#" class="tif-collapsible-button"><span>+</span></a>\n    </div>\n</div>\n\n<div class="tif-search-listview-expandable g-line-dotted"></div>'}),define("tif/js/views/search/DestinationView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/js/tif-img-responsive","tif/constants","tif/i18n","tif/js/tif-utils","v2/lib/text!tif/templates/destination-block-template.html","v2/lib/text!tif/templates/list-view-template.html"],function(e,t,n,r,i,s,o,u,a){var f=t.template(u),l=t.template(a),c=n.View.extend({tagName:"div",initialize:function(e){this.pageModel=e.pageModel,this.viewMode=this.pageModel.get("view"),this._data=null,this._searchLoaded=!1,this._blockLoaded=!1,this.listenTo(this.model,"change:contentEnriched",this.render)},events:{"click .tif-search-listview-row":"_listItemClicked"},render:function(){var e=this._data=this.model.toJSON(),t=this.pageModel.get("origin"),n={destination:this.model.get("destinationCode"),origin:t};e.linkMap={};for(var r=0;r<e.links.length;r++)e.linkMap[e.links[r].rel]=e.links[r].href;e.linkMap.flights&&(e.destinationUrl=o.rewriteUrl(e.linkMap.flights,n),e.destinationPriceUrl=o.rewriteUrl(e.linkMap.flights,n)),e.linkMap.overview&&(e.destinationUrl=o.rewriteUrl(e.linkMap.overview,n)),e.linkMap.calendar&&(e.destinationUrl=o.rewriteUrl(e.linkMap.calendar,n),e.destinationPriceUrl=o.rewriteUrl(e.linkMap.calendar,n)),e.contentEnriched&&(e.visualUrlSmall=e.visualUrlSmall||i.staticPath+"/img/destination-default-image.jpg",e.visualUrlMedium=e.visualUrlMedium||i.staticPath+"/img/destination-default-image.jpg");var u,a;return this.viewMode==="list"?(u=l({data:e,i18n:s.labels}),a="tif-search-listview"):(u=f({data:e,i18n:s.labels}),a="tif-search-blockview"),this.$el.html(u).addClass(a),this},destroy:function(){r.clean({container:".tif-search-results"}),this.remove()},_listItemClicked:function(t){t.preventDefault();if(this.viewMode!=="list")return;var n=e(t.target).closest(".tif-search-listview"),o=n.find(".tif-collapsible-button span"),u=e(t.target).position().top-30,a=n.find(".tif-search-listview-expandable"),l=a.find(".tif-search-destination");if(!this._blockLoaded){var c=f({data:this._data,i18n:s.labels});a.html(c),l=a.find(".tif-search-destination"),this._blockLoaded=!0}a.is(":visible")?(n.removeClass("tif-selected"),o.text("+").removeClass("active"),a.hide(),l.css({visibility:"hidden"})):(n.addClass("tif-selected"),o.text("-").addClass("active"),a.slideDown(250,function(){e("html").hasClass("lt-ie9")?l.css({visibility:"visible"}):l.fadeOut(0).css({visibility:"visible"}).fadeIn(350)}),e(window).width()<i.tabletBreakpoint&&e(window).scrollTop()<u&&e("html, body").animate({scrollTop:u+"px"},400),r.crawl({container:n}))}});return c}),define("tif/js/views/search/DestinationsCollectionView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/js/tif-img-responsive","tif/js/views/search/DestinationView"],function(e,t,n,r,i){var s=n.View.extend({initialize:function(e,t,n,i){this.$el=e,this._views=[],this.pageModel=t,this.pageModel.on("change:visibleItems",this.update,this),this.filteredDestinationsCollection=n,this.filteredDestinationsCollection.on("reset",this.draw,this),this.filteredDestinationsCollection.on("contentEnrichmentDone",function(){r.crawl({container:this.$el})}),this.allDestinationsCollection=i,this.allDestinationsCollection.on("startFetching",this._showSpinner,this),this.allDestinationsCollection.on("fetchingDone",this._hideSpinner,this)},draw:function(){this._remove();var e=this.filteredDestinationsCollection.first(this.pageModel.get("visibleItems"));this.render(e)},_remove:function(){var e=this._views.length;while(e--)this._views[e].destroy();this._views=[]},update:function(){var e=[],t=this.$el.children().length,n=this.pageModel.get("visibleItems"),r=this.filteredDestinationsCollection.length,i=n<r?n:r;for(var s=t;s<i;s++)e.push(this.filteredDestinationsCollection.at(s));this.render(e)},render:function(e){var n=document.createDocumentFragment();t.each(e,function(e){var t=new i({model:e,pageModel:this.pageModel});this._views.push(t),n.appendChild(t.render().el)},this),this.$el.append(n),n=null,r.crawl({container:this.$el}),this.$el.removeClass("g-loading-large")},_showSpinner:function(){this.$el.children().css("display","none"),this.$el.addClass("g-loading-large")},_hideSpinner:function(){this.$el.children().css("display","block"),this.$el.removeClass("g-loading-large")}});return s}),define("tif/js/views/search/ResultCounterView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/i18n"],function(e,t,n,r){var i=n.View.extend({initialize:function(e,t){this.$el=e,t.on("reset",this.render,this)},render:function(e){if(this.$el.size())if(e.length===0)this.$el.css({visibility:"hidden"});else{var t=e.length===1?r.labels.tif_search_xxdestination:r.labels.tif_search_xxdestinations;this.$el.text(t.replace(/\{0\}/,e.length)).css({visibility:"visible"})}return this.el}});return i}),define("tif/js/views/search/PaginationView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone"],function(e,t,n){var r=n.View.extend({initialize:function(e,t,n){this.$el=e,this.$linkEl=e.find("a"),this.$label=e.find("b"),this.filteredDestinationsCollection=n,this.pageModel=t,this.filteredDestinationsCollection.on("reset",this.updateState,this),this.pageModel.on("change:visibleItems",this.updateState,this)},events:{click:"showMore"},updateState:function(){var e=this.filteredDestinationsCollection.length,t=this.pageModel.get("visibleItems");t<e?this.$linkEl.removeClass("g-btn-disabled"):this.$linkEl.addClass("g-btn-disabled"),this.$label.removeClass("g-loading-small")},showMore:function(e){return e.preventDefault(),this.$linkEl.hasClass("g-btn-disabled")||(this.$label.addClass("g-loading-small"),this.pageModel.increaseVisibleItems()),!1}});return r}),define("tif/js/views/search/FilterCrumbsView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/i18n"],function(e,t,n,r,i){var s=n.View.extend({initialize:function(t,n){this.$el=t,this.$filterCrumb=t.find(".tif-search-filtercrumbs"),this.$window=e(window),this.pageModel=n,this.listenTo(this.pageModel,"change:origin change:continent change:country change:theme change:budget",this.render),this.$window.width()<r.tabletBreakpoint&&this.render()},events:{"click .tif-search-filtercrumbs-filter":"_filterCrumbClicked","click .tif-search-filtercrumbs-add":"_filterAddClicked"},render:function(){if(this.$filterCrumb.size()){var n=[];typeof this.pageModel!="undefined"&&t.each(this.pageModel.attributes,function(e,s){if(e===this.pageModel.defaults[s])return;switch(s){case"continent":t.each(e,function(e){n.push(this.wrapFilterCrumb(s,e,i.continents[e]))},this);break;case"country":t.each(e,function(e){n.push(this.wrapFilterCrumb(s,e,i.countries[e]))},this);break;case"theme":t.each(e,function(e){n.push(this.wrapFilterCrumb(s,e,i.themes[e].name))},this);break;case"budget":var o=r.currency||"";n.push(this.wrapFilterCrumb(s,e,i.labels.tif_search_filtercrumbs_max+" "+e+" "+o))}},this);if(n.length||this.$window.width()<700){var s=e('<ul class="g-clear"><li><div class="tif-search-filtercrumbs-label g-font-klm">'+i.labels.tif_search_filtercrumbs_selected+":</div></li></ul>");n.length>0&&s.append(n.join(" ")),s.append('<li><a href="#" class="tif-search-filtercrumbs-add">'+i.labels.tif_search_filtercrumbs_add+' <span class="g-klmicon">+</span></a></li>'),this.$filterCrumb.html(s).show(),this.$el.addClass("tif-showborder"),(this.$filterCrumb.height()>=66||this.$window.width()<700)&&this.$filterCrumb.find("li:first").addClass("tif-search-filtercrumbs-label-break")}else this.$filterCrumb.hide(),this.$el.removeClass("tif-showborder")}return this.el},wrapFilterCrumb:function(e,t,n){return'<li><a href="#" class="js-g-mi tif-search-filtercrumbs-filter" data-g-mi="tif.page.'+r.page+'.filter.crumb" '+'data-event-value="'+e+"-"+t+'" '+'data-property="'+e+'" '+'data-value="'+t+'">'+n+' <span class="g-klmicon">&#x78;</span></a></li>'},_filterCrumbClicked:function(n){n.preventDefault();var r=e(n.target).closest("a"),i=r.data("property"),s=r.data("value");t.isArray(this.pageModel.get(i))?this.pageModel.set(i,t.without(this.pageModel.get(i),s)):this.pageModel.set(i,this.pageModel.defaults[i])},_filterAddClicked:function(t){t.preventDefault();var n=e(".tif-search-filters-mobile").offset().top;this.$window.scrollTop(n)}});return s}),define("tif/js/views/search/ToggleViewsView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants"],function(e,t,n,r){var i=n.View.extend({initialize:function(e,t,n){this.$el=e,this.pageModel=t,this.filteredDestinationsCollection=n,this.filteredDestinationsCollection.on("reset",this._showToggle,this)},events:{"click .tif-search-change-view-button":"_changeViewButtonClicked"},_showToggle:function(){var e=this,n=e.pageModel.get("view"),i=r.viewModes;if(e.filteredDestinationsCollection.length){var s="";t.each(i,function(e,t){var r=n===t?" active":"";s+='<li><a href="#" class="js-g-mi tif-search-change-view-button'+r+'" '+'data-mode="'+t+'" '+'data-g-mi="tif.page.search.viewtoggle" '+'data-event-value="'+t+'">'+'<span class="tif-icon">'+e.icon+"</span>"+"</a></li>"}),e.$el.html('<ul class="g-clear">'+s+"</ul>"),s=""}else e.$el.empty()},_changeViewButtonClicked:function(t){t.preventDefault();var n=e(t.target).closest("a").attr("data-mode");this.pageModel.resetVisibleItems(n),this.pageModel.set("view",n)}});return i}),define("tif/js/views/search/SortView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/js/tif-measure"],function(e,t,n,r,i){var s=n.View.extend({initialize:function(e,t,n){this.$el=e,this.pageModel=t,this.pageModel.on("change:sortBy",this.update,this),this.filteredDestinationsCollection=n,this.filteredDestinationsCollection.on("reset",this.render,this)},events:{"change select":"_selectBoxClicked"},render:function(){if(this.filteredDestinationsCollection.length){var e=[];t.each(r.sortModes,function(t){var n="";t.mode===this.pageModel.get("sortBy")&&(n=' selected="selected"');var r='<option value="'+t.mode+'"'+n+">"+t.label+"</option>";e.push(r)},this),this.$el.html('<select class="tif-select g-forms-selectbox">'+e.join("")+"</select>")}else this.$el.empty()},update:function(){this.$el.find(".tif-select").val(this.pageModel.get("sortBy"))},_selectBoxClicked:function(t){var n=e(t.target);i.send("tif.page."+r.page+".change.sort",{z_eventvalue:n.val()}),this.pageModel.resetVisibleItems(),this.pageModel.set({sortBy:n.val()})}});return s}),define("v2/lib/text!tif/templates/noresult-template.html",[],function(){return'<h4 class="tif-heading-dark tif-h4"><@=i18n.tif_search_noresult_header@></h4>\n<p><@=i18n.tif_search_noresult_body@></p>'}),define("tif/js/views/search/NoResultView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/i18n","v2/lib/text!tif/templates/noresult-template.html"],function(e,t,n,r,i){var s=n.View.extend({template:t.template(i),initialize:function(e,t,n){this.$el=e,this.filteredDestinationsCollection=n,this.filteredDestinationsCollection.on("reset",this.render,this),this.allDestinationsCollection=t,this.allDestinationsCollection.on("showNoResultMessage",function(){this.$el.removeClass("g-hidden")},this),this.$el.html(this.template({i18n:r.labels}))},render:function(){return this.filteredDestinationsCollection.length?this.isANoResultReset?this.isANoResultReset=!1:this.$el.addClass("g-hidden"):(this.isANoResultReset=!0,this.$el.removeClass("g-hidden")),this}});return s}),define("v2/lib/text!tif/templates/breadcrumb-template.html",[],function(){return'<@ _.each(breadCrumbArray, function(obj, count){ @>\n	<@ if (count < breadCrumbArray.length - 1) { @>\n		<li class="js-g-mi tif-breadcrumbs-filter-item"\n            data-g-mi="tif.page.<@=obj.page@>.filter.breadcrumb"\n            data-event-value="<@- obj.type @>-<@- obj.code @>"\n            data-code="<@- obj.code @>"\n            data-type="<@- obj.type @>">\n		    <span class="tif-breadcrumbs-separator g-klmicon tif-icon-gt-small">&gt;</span>\n		    <a href="#" class="g-line-dotted-white"><@- obj.name @></a>\n		</li>\n	<@ } else { @>\n		<li class="last"><span class="tif-breadcrumbs-separator g-klmicon tif-icon-gt-small">&gt;</span>\n		    <span><@- obj.name @></span>\n		</li>\n	<@ } @>\n<@ }); @>'}),define("tif/js/views/search/BreadCrumbsView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/i18n","tif/constants","tif/js/tif-regions","v2/lib/text!tif/templates/breadcrumb-template.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({initialize:function(e,n){this.$el=e,this.$list=this.$el.find("ul"),this.$firstItem=this.$list.find("li").first(),this.pageModel=n,this.pageModel.on("change:continent change:country",this.render,this),this.breadCrumbTemplate=t.template(o)},events:{"click a":"breadCrumbItemClicked"},render:function(){var e=[],n=this.$list.empty().append(this.$firstItem),o=this.pageModel.get("continent"),u=this.pageModel.get("country"),a="";if(o.length===1&&u.length===0)a=o[0],e.push({name:r.continents[a]});else if(o.length===0&&u.length===1){var f=u[0];t.each(s.world.continents,function(e,t){f in e.countries&&(a=t)}),e.push({name:r.continents[a],code:a,type:"continent",page:i.page}),e.push({name:r.countries[f]})}n.append(this.breadCrumbTemplate({breadCrumbArray:e})),this.$el=n},breadCrumbItemClicked:function(n){n.preventDefault();var r=e(n.target),i=t.clone(this.pageModel.defaults);i.origin=this.pageModel.get("origin"),i.pos=this.pageModel.get("pos"),i.view=this.pageModel.get("view"),i.visibleItems=this.pageModel.get("visibleItems");var s=r.closest(".tif-breadcrumbs-filter-item").data();this.pageModel.resetVisibleItems(),s&&s.code?(i.continent=[s.code],this.pageModel.set(i)):this.pageModel.set(i)}});return u}),define("tif/js/views/destination/BreadCrumbsView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/i18n","tif/js/tif-regions","v2/lib/text!tif/templates/breadcrumb-template.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({initialize:function(e,n){this.$el=e,this.$list=this.$el.find("ul"),this.$firstItem=this.$list.find("li").first(),this.pageModel=n,this.breadCrumbTemplate=t.template(o),this.render()},events:{"click a":"breadCrumbItemClicked"},render:function(){var e=[],n=this.$list.empty().append(this.$firstItem);t.each(s.world.continents,function(n,s){t.each(n.countries,function(n,o){t.each(n.cities,function(t,n){n===r.destCode&&(e.push({name:i.continents[s],code:s,type:"continent",page:r.page}),e.push({name:i.countries[o],code:o,type:"country",page:r.page}),e.push({name:i.cities[n]}))})})}),n.append(this.breadCrumbTemplate({breadCrumbArray:e})),this.$el=n},breadCrumbItemClicked:function(t){t.preventDefault();var n=e(t.target),i=r.searchUrl+"#origin="+this.pageModel.get("origin")+"&pos="+this.pageModel.get("pos"),s=n.closest(".tif-breadcrumbs-filter-item").data();s&&(s.type==="country"?i+="&country="+s.code:s.type==="continent"&&(i+="&continent="+s.code)),window.location=i}});return u}),define("v2/lib/text!tif/templates/backtosearch-template.html",[],function(){return'<span aria-hidden="true" class="g-klmicon tif-icon-gt-small">&lt;</span>\n<a class="js-g-mi" href="#<@=url@>" data-g-mi="tif.page.destination.backtosearch"><@=i18n.tif_destination_backtoresults@></a>'}),define("tif/js/views/destination/BackToSearchView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/constants","tif/i18n","v2/lib/text!tif/templates/backtosearch-template.html"],function(e,t,n,r,i,s){var o=n.View.extend({initialize:function(e){this.$el=e,this._backToSearchTemplate=t.template(s),this.showButton()},events:{"click a":"_linkClicked"},showButton:function(){if(r.storageSupport){var e=JSON.parse(window.sessionStorage.getItem("tif:model"));e&&this.$el.html(this._backToSearchTemplate({url:r.searchUrl,i18n:i.labels}))}},_linkClicked:function(t){t.preventDefault();if(r.storageSupport){var n=JSON.parse(window.sessionStorage.getItem("tif:model")),i=r.searchUrl;n&&(i+="#"+e.param(n,!0)),window.location=i;try{window.sessionStorage.setItem("tif:lastViewedDestination",r.destCode)}catch(s){}}}});return o}),define("tif/js/views/destination/PracticalInfoTeaserView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone"],function(e,t,n){var r=n.View.extend({initialize:function(e,t){this.$el=e,this.pageModel=t},events:{"click a":"_linkClicked"},_linkClicked:function(t){t.preventDefault();var n=e(t.target);this.pageModel.anchor=n.attr("data-anchor"),this.pageModel.set({tab:"practical-info"})}});return r}),define("tif/js/views/destination/PriceboxView",["v2/lib/jquery","v2/lib/backbone","tif/constants","tif/js/tif-timetable"],function(e,t,n,r){var i=t.View.extend({initialize:function(e,t){this.$el=e,this.destinationPageModel=t,this.destinationPageModel.on("change:origin",this._render,this),this.destcode=this.$el.data("destcode")},events:{"click a":"_priceBoxClicked"},_render:function(){var t=this,i=this.destinationPageModel.get("origin"),s=this.destcode;if(i===s)return;r.init({origin:i}),t.$el.addClass("g-loading-large").empty();var o="/destinations/"+n.country+"/"+n.language+"/pricebox/"+s+"?origin="+i;return e.ajax({url:o,dataType:"html"}).done(function(e){t.$el.html(e).show(),t.$el.removeClass("g-loading-large")}).fail(function(){t.$el.removeClass("g-loading-large").hide()}),this.el},_priceBoxClicked:function(t){t.preventDefault(),this.destinationPageModel.set({tab:"flights"}),e("html, body").animate({scrollTop:e(".tif-content").offset().top},300)}});return i}),define("v2/lib/text!tif/templates/tips-articles-template.html",[],function(){return'<@_.each(themes, function(theme, count){ @>\n    <li class="<@ if (theme.active) { @>tif-destination-articles-themes-selected<@ } @> <@ if (theme.disabled) { @>tif-destination-articles-themes-disabled<@ } @>">\n        <span class="tif-icon"><@=theme.icon@></span>\n        <@ if(theme.disabled || theme.active){@>\n            <span><@=theme.name@></span>\n        <@ } else {@>\n            <a data-theme="<@=theme.code@>" href="#"><@=theme.name@></a>\n        <@ }@>\n        <span aria-hidden="true" class="g-klmicon tif-icon-gt-small tif-color-blue-1">&gt;</span>\n    </li>\n<@ }) @>\n'}),define("tif/js/views/destination/TipsAndArticlesView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","v2/g-window-events","tif/js/tif-img-responsive","tif/i18n","v2/lib/text!tif/templates/tips-articles-template.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({initialize:function(e,n){this.$el=e,this.destinationPageModel=n,this.destinationPageModel.on("change:articleTheme",this._filter,this),this.destinationPageModel.on("change:articleTheme",this._render,this),this.tipsArticlesTemplate=t.template(o),this.availableThemes=this._findAvailableThemes(),this._render(),this._filter(),r.onResize(this.equalizeHeight)},events:{"click .tif-destination-articles-themes a":"_themeClicked"},_findAvailableThemes:function(){var n=[],r=this.$el.find(".tif-destination-articles-article");return r.each(function(){n.push(e(this).data().themes.replace(/^\[|\]$/g,"").split(", "))}),t.uniq(t.flatten(n))},_render:function(){var e=[],n=this.$el.find(".tif-destination-articles-themes").data().themes.split(",");n.pop();var r=this.$el.find(".tif-destination-articles-themes ul"),i=this.destinationPageModel.get("articleTheme");e.push({active:i==="all",code:"all",name:s.labels.tif_destination_tab_articles_all_tips_articles,icon:"&#xe118;",disabled:!1}),t.each(n,function(n){var r={active:i===n,code:n,name:s.themes[n].name,icon:s.themes[n].icon,disabled:!t.contains(this.availableThemes,n)};e.push(r)},this),r.html(this.tipsArticlesTemplate({themes:e}))},_filter:function(){var n=this.destinationPageModel.get("articleTheme");this.$el.find(".tif-destination-articles-article").removeClass("g-hidden"),n!=="all"&&this.$el.find(".tif-destination-articles-article").filter(function(){var r=e(this).data().themes.replace(/^\[|\]$/g,"").split(", ");return!t.contains(r,n)}).addClass("g-hidden"),i.crawl({container:this.$el}),this.equalizeHeight()},_themeClicked:function(t){t.preventDefault();var n=e(t.target),r=n.attr("data-theme");this.destinationPageModel.set({articleTheme:r||"all"})},equalizeHeight:function(){var t=e(".tif-destination-articles-article");if(window.Modernizr.mq("(min-width: 480px)")){var n=0;t.each(function(){var t=e(this).height();t>n&&(n=t)}),t.height(n)}else t.height("auto")}});return u}),define("tif/js/views/TabsView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","v2/g-window-events","tif/constants","tif/js/tif-img-responsive","v2/g-initcomponents"],function(e,t,n,r,i,s,o){var u=n.View.extend({initialize:function(t,n){this.$el=t,this.$window=e(window),this.$el.tabsNav=this.$el.find(".tif-tabs-nav"),this.$el.tabsList=this.$el.tabsNav.find(".tif-tabs-nav-list"),this.$el.tabAnchors=this.$el.tabsList.find(".tif-tab-text"),this.$el.contentwrapper=this.$el.find(".tif-tabs-content-wrapper"),this.$el.mobileNavButton=this.$el.find(".tif-tabs-nav-mobile-toggle"),n.pageModel&&(this.pageModel=n.pageModel,this.pageModel.on("change:tab",this._toggleTab,this),this.pageModel.on("tabLoaded",this.initNewTabContent,this)),n.allDestinationsCollection&&(this.allDestinationsCollection=n.allDestinationsCollection),n.ChangeOriginView&&(this.ChangeOriginView=n.ChangeOriginView),n.BackToSearchView&&(this.BackToSearchView=n.BackToSearchView),n.PracticalInfoTeaserView&&(this.PracticalInfoTeaserView=n.PracticalInfoTeaserView),n.TipsAndArticlesView&&(this.TipsAndArticlesView=n.TipsAndArticlesView),this.sticky=n.sticky||!1,this.togglable=n.togglable||!1,this.scrollToTopOnClick=n.scrollToTopOnClick||!1,this.tabsTop=this.$el.offset().top,this.tabsHeight=this.$el.find(".tif-tabs-header").outerHeight(),this.sticky&&this.makeSticky(),this.$el.mobileNavButton.size()&&this.mobileNavToggle()},events:{"click a.tif-tab-text":"_tabClicked"},_tabClicked:function(t){t.preventDefault();var n=e(t.target),r=n.attr("data-tab-id");this.pageModel?this.pageModel.set("tab",r):this._toggleTab(null,{tabId:r,$target:n})},_toggleTab:function(t,n){var r,i;t?(r=this.pageModel.get("tab"),i=this.$el.find('[data-tab-id="'+r+'"]')):(r=n.tabId,i=n.$target);var s=i.attr("data-xhr-url"),o=i.closest("li"),u=this.$el.contentwrapper.find("#"+r),a=function(){var e=u.find("h1").text();e&&(document.title=e)};if(u.children().length===0&&!s)return;this.scrollToTopOnClick&&this.$window.scrollTop()>this.tabsTop&&this.$window.scrollTop(this.tabsTop);if(o.hasClass("tif-activetab")&&this.togglable)o.removeClass("tif-activetab"),this.$el.contentwrapper.find(".tif-tab-content").removeClass("tif-tab-content-active");else{this.$el.tabsNav.removeClass("tif-tabs-nav-mobile-toggle-open"),this.$el.tabAnchors.parents("li").removeClass("tif-activetab"),o.addClass("tif-activetab"),this.$el.contentwrapper.find(".tif-tab-content").removeClass("tif-tab-content-active"),u.addClass("tif-tab-content-active");if(s&&u.is(":empty")){var f=this,l='<div class="tif-tab-loading g-loading-large g-grid--row"></div>';u.append(l),e.ajax(s).done(function(e){u.html(e),a(),f.pageModel.trigger("tabLoaded"),f.pageModel&&f.pageModel.anchor&&f.scrollToAnchor(f.pageModel)}).error(function(){u.empty()})}else a(),this.pageModel&&this.pageModel.anchor&&this.scrollToAnchor(this.pageModel)}},initNewTabContent:function(){var e=this.pageModel.get("tab"),t=this.$el.contentwrapper.find("#"+e),n=t.find(".tif-destination-change-origin");if(n.length){var r=new this.ChangeOriginView(n,this.pageModel,this.allDestinationsCollection);r.updateLocationPicker()}var i=t.find(".tif-destination-backlink");if(i.length){var u=new this.BackToSearchView(i);u.showButton()}var a=t.find(".tif-practical-info-teaser");a.length&&new this.PracticalInfoTeaserView(a,this.pageModel);var f=t.find(".tif-destination-articles-container");f.length&&new this.TipsAndArticlesView(f,this.pageModel),s.crawl({container:t}),o.components([{className:"js-tif-init"}])},scrollToAnchor:function(e){var t=this.$el.find("."+e.anchor);t&&this.$window.scrollTop(t.offset().top-100),e.anchor=!1},makeSticky:function(){var e=this,t=function(){e.tabsTop=e.$el.offset().top,e.toBeFixedOrNotToBeFixed(e.$window.scrollTop())};e.$window.on("scroll",t),e.$window.trigger("scroll"),r.onResize(t,"debounce")},mobileNavToggle:function(){var e=this;this.$el.mobileNavButton.on("click",function(t){t.preventDefault(),e.$el.tabsNav.toggleClass("tif-tabs-nav-mobile-toggle-open")})},toBeFixedOrNotToBeFixed:function(e){!i.isMobile&&e>this.tabsTop&&this.$window.width()>=984?this.$el.hasClass("tif-tabs-make-sticky")||this.$el.addClass("tif-tabs-make-sticky").css({"padding-top":this.tabsHeight}):this.$el.hasClass("tif-tabs-make-sticky")&&this.$el.removeClass("tif-tabs-make-sticky").css({"padding-top":0})}});return u}),define("tif/js/views/ChangeOriginView",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","tif/js/tif-locationpicker","tif/constants","tif/js/tif-measure"],function(e,t,n,r,i,s){var o=n.View.extend({initialize:function(e,t,n){this.$el=e,this.$locationPicker=this.$el.find(".tif-change-origin-picker"),this.$locationText=this.$el.find(".tif-change-origin-text"),this.$el.css({visibility:"visible"}),this.pageModel=t,this.pageModel.on("change:origin",this.updateLocationPicker,this),this.allDestinationsCollection=n},updateLocationPicker:function(){if(!this.locationPicker){this.locationPicker=new r({country:this.pageModel.get("pos"),language:i.language,application:"TIF",container:this.$locationPicker,type:"origin",prefill:{code:this.pageModel.get("origin")}}),this.locationPicker.on("init",this.updateLocationPicker,this),this.locationPicker.on("selected",this.updatePageModel,this),this.locationPicker.on("close",this.updateLocationPicker,this);var e=this;this.$locationText.on("click",function(){e._showPicker(),e.locationPicker.open()})}else this.locationPicker.set({code:this.pageModel.get("origin")});this._showLocation()},updatePageModel:function(){var e=this,t=e.locationPicker.get(),n=i.currency;t.code!==e.pageModel.get("origin")&&(i.storageSupport&&window.sessionStorage.clear(),e.allDestinationsCollection.fetch(t.code,t.posCode,function(){e.pageModel.resetVisibleItems&&e.pageModel.resetVisibleItems();var r={origin:t.code,pos:t.posCode};i.storageSupport&&window.localStorage.setItem("tif:origin",JSON.stringify(r)),s.send("tif.page."+i.page+".change.origin",{z_eventvalue:e.pageModel.get("origin")+"-"+t.code}),e.pageModel.set(r),n!==i.currency&&e.pageModel.get("budget")&&e.pageModel.set({budget:null})}),e._showLocation()),e._hidePicker()},_showLocation:function(){var e=this.locationPicker.get();e&&(e.type==="AIRPORT"?this.$locationText.html(e.city+" - "+e.description+" ("+e.code+")"):e.type==="CITY"&&this.$locationText.html(e.city+" ("+e.code+")"),this._hidePicker())},_hidePicker:function(){this.$el.removeClass("tif-change-origin-show-picker")},_showPicker:function(){this.$el.addClass("tif-change-origin-show-picker")}});return o}),define("tif/js/tif-header-visual",["v2/lib/jquery","v2/g-pubsub","v2/g-window-events","tif/constants"],function(e,t,n,r){var i={},s={};return i.init=function(t){s.$el=t,s.$window=e(window),s.viewportWidth=s.$window.width(),s.viewportHeight=s.$window.height(),s.$document=e(document),s.$tifHeader=e(".tif-header"),s.$tifContent=e(".tif-content"),s.$breadcrumbs=e(".tif-breadcrumbs"),i.calculateHeights(),i.bindEvents(),i.parallaxImage(!0)},i.calculateHeights=function(){s.parallaxScroll=!0,s.documentHeight=s.$document.height(),s.headerHeight=s.$tifHeader.offset().top,s.breadCrumbsHeight=s.$breadcrumbs.height(),s.containerHeight=s.$tifHeader.height()+s.$tifContent.outerHeight(),s.imageHeight=1440,s.imageMode=s.viewportWidth>984?"large":s.viewportWidth<680?"small":"medium",s.imageUrl=s.$el.data("image-"+s.imageMode),s.startY=s.headerHeight,s.endY=s.containerHeight+s.headerHeight-s.viewportHeight,s.scrollTopOld=s.$window.scrollTop();if(s.viewportWidth<985){s.parallaxScroll=!1;var t=s.headerHeight;s.imageMode==="small"&&(document.body.style.backgroundSize="contain",t+=s.breadCrumbsHeight,e(".tif-breadcrumbs").css({top:s.headerHeight})),document.body.style.backgroundPosition="center "+t+"px",document.body.style.backgroundAttachment="scroll"}else s.viewportWidth>1024&&r.isMobile?(s.parallaxScroll=!1,document.body.style.backgroundPosition="center top",document.body.style.backgroundAttachment="scroll",document.body.style.backgroundRepeat="repeat-y"):s.viewportWidth>1920?(s.parallaxScroll=!1,document.body.style.backgroundPosition="center top",document.body.style.backgroundAttachment="fixed",document.body.style.backgroundSize="cover"):s.imageHeight>s.containerHeight?(s.parallaxScroll=!1,document.body.style.backgroundPosition="center "+s.headerHeight+"px",document.body.style.backgroundAttachment="scroll"):document.body.style.backgroundSize="auto"},i.bindEvents=function(){var e=function(e,t){s.viewportWidth=t.width,s.viewportHeight=t.height,r.viewport={width:t.width,height:t.height},i.calculateHeights(),i.parallaxImage()};n.onResize(e);var o,u=!1;s.$window.on("scroll",function(){clearTimeout(o),o=setTimeout(function(){u=!1},500);if(!u){u=!0;var e=s.$document.height();e!==s.documentHeight&&(s.documentHeight=e,i.calculateHeights())}i.parallaxImage()}),t.subscribe("cookiebar:cookiebarclosed",function(){i.calculateHeights(),i.parallaxImage(!0)})},i.parallaxImage=function(e){if(!s.parallaxScroll)return;var t=s.$window.scrollTop();if(!e&&s.scrollTopOld===t)return!1;s.scrollTopOld=t;var n=(t-s.startY)/(s.endY-s.startY)*100;n<0&&(n=0),n>100&&(n=100);var r=0,i,o=0;n>0&&n<100?(o=s.viewportHeight-s.imageHeight+s.startY,i="fixed"):(o=s.containerHeight+s.headerHeight-s.imageHeight,r+=s.headerHeight,i="scroll"),r+=Math.round(o/100*n),document.body.style.backgroundPosition="center "+r+"px",document.body.style.backgroundAttachment=i},i}),define("tif/js/tif-search-filters-mobile",["v2/lib/jquery","v2/g-newpage"],function(e,t){var n={},r={};return n.init=function(n){r.$el=n,r.$searchFilters=e(".tif-tabs-search-filters"),r.$el.find("a").on("click",function(n){n.preventDefault();var i=e("#"+e(this).data("tab-id"));r.mobileNewPage=new t({id:"tif-search-filters-mobile-newpage"}),r.mobileNewPage.setContent(i),r.mobileNewPage.on("open",function(){e(window).scrollTop(0)}),r.mobileNewPage.on("close",function(){var t=e(".g-newpage .g-newpage-content").contents();r.$searchFilters.find(".tif-tabs-content-wrapper").append(t),setTimeout(function(){e(window).scrollTop(r.$searchFilters.offset().top),r.mobileNewPage.destroy()},10)}),r.mobileNewPage.open()})},n}),define("tif/js/tif-country-language",["v2/g-pubsub","tif/constants"],function(e,t){var n={};return n.handleSwitch=function(e,r){var i=r[0],s=document.location.href,o=n.convertUrl(s,i);t.storageSupport&&window.sessionStorage.clear(),typeof o=="string"&&(document.location=o)},n.convertUrl=function(e,t){var n=/\/\w{2}\/\w{2}/im;if(!(t.country&&t.language&&typeof t.country=="string"&&typeof t.language=="string"&&n.test(e)))return!1;var r=("/"+t.country+"/"+t.language).toLowerCase(),i=e.replace(n,r);return n.test(i)===!1&&(i=!1),i},n.init=function(){e.subscribe("cms.countrylang.switch",n.handleSwitch)},{init:n.init,convertUrl:n.convertUrl}}),define("tif/js/tif",["v2/lib/jquery","v2/lib/lodash","v2/lib/backbone","v2/g-initcomponents","tif/constants","tif/i18n","tif/js/tif-utils","tif/js/tif-regions","tif/js/models/DestinationPageModel","tif/js/models/SearchPageModel","tif/js/collections/AllDestinationsCollection","tif/js/collections/FilteredDestinationsCollection","tif/js/views/DestinationView","tif/js/views/SearchView","tif/js/views/search/SearchFiltersView","tif/js/views/search/RegionFilterView","tif/js/views/search/ThemesFilterView","tif/js/views/search/BudgetFilterView","tif/js/views/search/DestinationsCollectionView","tif/js/views/search/ResultCounterView","tif/js/views/search/PaginationView","tif/js/views/search/FilterCrumbsView","tif/js/views/search/ToggleViewsView","tif/js/views/search/SortView","tif/js/views/search/NoResultView","tif/js/views/search/BreadCrumbsView","tif/js/views/destination/BreadCrumbsView","tif/js/views/destination/BackToSearchView","tif/js/views/destination/PracticalInfoTeaserView","tif/js/views/destination/PriceboxView","tif/js/views/destination/TipsAndArticlesView","tif/js/views/TabsView","tif/js/views/ChangeOriginView","tif/js/tif-header-visual","tif/js/tif-search-filters-mobile","tif/js/tif-measure","tif/js/tif-country-language"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){var j=function(){var s=t.extend({},n.Events),d,j,F,I;e.support.cors=!0,u.init(),B.init();var q=o.getParamsFromHash();if(i.storageSupport&&window.localStorage.getItem("tif:origin")){var R=JSON.parse(window.localStorage.getItem("tif:origin"));i.defaultOrigin=q.origin||R.origin,i.defaultPos=q.pos||R.pos}i.page==="search"?(d=new f,j=new l,F=new c(null,{allDestinationsCollection:j,pageModel:d}),new v(e("#tif-filter-regions"),d,j),new m(e("#tif-filter-themes"),d,F),new g(e("#tif-filter-budget"),d),new y(e(".tif-search-results-container"),d,F,j),new b(e(".tif-search-result-counter"),F),new w(e(".tif-search-results-more-destinations"),d,F),new E(e(".tif-search-filtercrumbs-container"),d),new S(e(".tif-search-change-view"),d,F),new x(e(".tif-search-change-sorting"),d,F),new _(e(".tif-search-change-origin"),d,j),new N(e(".tif-breadcrumbs"),d),new T(e(".tif-search-no-result-message"),j,F),new M(e(".tif-tabs-search-filters"),{sticky:!0,togglable:!0,scrollToTopOnClick:!0}),new p({el:null,pageModel:d,allDestinationsCollection:j,filteredDestinationsCollection:F,vent:s}),j.fetch(i.defaultOrigin,i.defaultPos,function(){var t;i.storageSupport&&window.sessionStorage.getItem("tif:model")&&(t=JSON.parse(window.sessionStorage.getItem("tif:model")));if(t&&o.containsSameProperties(t,q)){d.set(t);var n=window.sessionStorage.getItem("tif:lastViewedDestination");if(n){var r=e('.tif-search-results-container [data-dest="'+n+'"]');r.length&&e(window).scrollTop(r.offset().top-200)}}else e(window).trigger("hashchange")}),i.storageSupport&&window.sessionStorage.removeItem("tif:lastViewedDestination"),H.init(d,F)):i.page==="destination"&&(i.activeTab&&i.activeTab==="flights"&&(i.scroll=!0),I=new a,j=new l,new A(e(".tif-pricebox-container"),I),new v(e("#tif-filter-regions"),I,j),new m(e("#tif-filter-themes"),I),new g(e("#tif-filter-budget"),I),e(".tif-destination-change-origin").length&&new _(e(".tif-destination-change-origin"),I,j),new C(e(".tif-breadcrumbs"),I),new k(e(".tif-destination-backlink")),e(".tif-practical-info-teaser").length&&new L(e(".tif-practical-info-teaser"),I),e(".tif-destination-articles-container").length&&new O(e(".tif-destination-articles-container"),I),new M(e(".tif-tabs-destination-page"),{pageModel:I,allDestinationsCollection:j,ChangeOriginView:_,BackToSearchView:k,PracticalInfoTeaserView:L,TipsAndArticlesView:O,sticky:!0,toggable:!1,scrollToTopOnClick:!0}),new M(e(".tif-tabs-search-filters"),{sticky:!1,toggable:!1,scrollToTopOnClick:!1}),new h({el:null,pageModel:I,vent:s}),H.init(I),r.components([{className:"js-tif-init"}]),j.fetch(i.defaultOrigin,i.defaultPos,function(){e(window).trigger("hashchange")})),D.init(e(".tif-header-visual")),P.init(e(".tif-search-filters-mobile")),H.send("tif.page."+i.page+".onload")};return{init:j}});